var T=Object.defineProperty;var M=(a,s,t)=>s in a?T(a,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[s]=t;var y=(a,s,t)=>M(a,typeof s!="symbol"?s+"":s,t);import{r as o,a as H}from"./vendor-SIwY82C9.js";import{W as I,V as k,a as $,b as V}from"./bluetooth-DyS4SozQ.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const c of r.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&i(c)}).observe(document,{childList:!0,subtree:!0});function t(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerPolicy&&(r.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?r.credentials="include":n.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function i(n){if(n.ep)return;n.ep=!0;const r=t(n);fetch(n.href,r)}})();var P={exports:{}},D={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var G=o,W=Symbol.for("react.element"),z=Symbol.for("react.fragment"),_=Object.prototype.hasOwnProperty,K=G.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,q={key:!0,ref:!0,__self:!0,__source:!0};function B(a,s,t){var i,n={},r=null,c=null;t!==void 0&&(r=""+t),s.key!==void 0&&(r=""+s.key),s.ref!==void 0&&(c=s.ref);for(i in s)_.call(s,i)&&!q.hasOwnProperty(i)&&(n[i]=s[i]);if(a&&a.defaultProps)for(i in s=a.defaultProps,s)n[i]===void 0&&(n[i]=s[i]);return{$$typeof:W,type:a,key:r,ref:c,props:n,_owner:K.current}}D.Fragment=z;D.jsx=B;D.jsxs=B;P.exports=D;var e=P.exports,L,R=H;L=R.createRoot,R.hydrateRoot;const J=({onDeviceSelected:a,isScanning:s,onScanStateChange:t})=>{const[i,n]=o.useState([]),[r,c]=o.useState(null),[u]=o.useState(()=>new I),v=o.useCallback(async()=>{c(null),t(!0);try{const l=await u.requestDevice();if(l.success&&l.data){const h=l.data;n(f=>f.find(b=>b.id===h.id)?f:[...f,h]),a(h)}else c(l.error||"Device scan failed")}catch(l){c(l instanceof Error?l.message:"Unknown scanning error")}finally{t(!1)}},[u,a,t]),p=o.useCallback(l=>{a(l)},[a]),g=o.useCallback(()=>{c(null)},[]);return e.jsxs("div",{className:"device-scanner",children:[e.jsxs("div",{className:"scanner-header",children:[e.jsx("h2",{children:"Blackmagic Device Scanner"}),e.jsx("button",{className:`scan-button ${s?"scanning":""}`,onClick:v,disabled:s,children:s?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"spinner"}),"Scanning..."]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"scan-icon",children:"üì°"}),"Scan for Devices"]})})]}),r&&e.jsxs("div",{className:"error-message",children:[e.jsx("span",{className:"error-icon",children:"‚ö†Ô∏è"}),e.jsx("span",{className:"error-text",children:r}),e.jsx("button",{className:"error-dismiss",onClick:g,children:"√ó"})]}),i.length>0&&e.jsxs("div",{className:"device-list",children:[e.jsx("h3",{children:"Available Devices"}),i.map(l=>{var h;return e.jsxs("div",{className:"device-item",onClick:()=>p(l),children:[e.jsxs("div",{className:"device-info",children:[e.jsx("div",{className:"device-name",children:l.name||"Unnamed Device"}),e.jsxs("div",{className:"device-id",children:["ID: ",l.id]}),((h=l.gatt)==null?void 0:h.connected)&&e.jsx("div",{className:"device-status connected",children:"Connected"})]}),e.jsx("div",{className:"device-actions",children:e.jsx("button",{className:"select-button",children:"Select"})})]},l.id)})]}),!s&&i.length===0&&e.jsxs("div",{className:"empty-state",children:[e.jsx("div",{className:"empty-icon",children:"üîç"}),e.jsx("p",{children:'No devices found. Click "Scan for Devices" to search for Bluetooth devices.'}),e.jsxs("div",{className:"tips",children:[e.jsx("h4",{children:"Tips:"}),e.jsxs("ul",{children:[e.jsx("li",{children:"Make sure your Bluetooth device is powered on and discoverable"}),e.jsx("li",{children:"Enable Bluetooth pairing mode on your device"}),e.jsx("li",{children:"Ensure you're using a supported browser (Chrome/Edge with HTTPS)"}),e.jsx("li",{children:"Check that Web Bluetooth is enabled in your browser settings"}),e.jsx("li",{children:"For Blackmagic cameras, enable Bluetooth in camera settings"})]})]})]})]})},Y=({device:a,onConnectionStateChange:s,onServicesDiscovered:t})=>{const[i,n]=o.useState({connected:!1,connecting:!1,device:null,services:[],characteristics:new Map,error:null}),[r]=o.useState(()=>new I),[c,u]=o.useState(null);o.useEffect(()=>{a&&n(l=>({...l,device:a,error:null}))},[a]),o.useEffect(()=>{s(i)},[i,s]);const v=o.useCallback(async()=>{if(a){n(l=>({...l,connecting:!0,error:null}));try{const l=await r.connect();if(l.success){n(f=>({...f,connected:!0,connecting:!1})),u("Discovering services...");const h=await r.discoverServices();h.success&&h.data?(n(f=>{var m;return{...f,services:((m=h.data)==null?void 0:m.map(()=>({})))||[]}}),t(h.data),u(null)):(n(f=>({...f,error:h.error||"Service discovery failed"})),u(null))}else n(h=>({...h,connecting:!1,error:l.error||"Connection failed"}))}catch(l){n(h=>({...h,connecting:!1,error:l instanceof Error?l.message:"Connection error"})),u(null)}}},[a,r,t]),p=o.useCallback(async()=>{try{await r.disconnect(),n(l=>({...l,connected:!1,connecting:!1,services:[],characteristics:new Map,error:null})),u(null)}catch(l){console.error("Disconnect error:",l)}},[r]),g=o.useCallback(()=>{n(l=>({...l,error:null}))},[]);return a?e.jsxs("div",{className:"connection-manager",children:[e.jsxs("div",{className:"connection-header",children:[e.jsx("h3",{children:"Device Connection"}),e.jsx("div",{className:`connection-status ${i.connected?"connected":i.connecting?"connecting":"disconnected"}`,children:i.connected?"üü¢ Connected":i.connecting?"üü° Connecting...":"üî¥ Disconnected"})]}),e.jsxs("div",{className:"device-details",children:[e.jsxs("div",{className:"device-info",children:[e.jsx("h4",{children:a.name||"Unnamed Device"}),e.jsxs("div",{className:"device-meta",children:[e.jsxs("span",{className:"device-id",children:["ID: ",a.id]}),a.gatt&&e.jsxs("span",{className:"gatt-status",children:["GATT: ",a.gatt.connected?"Connected":"Disconnected"]})]})]}),e.jsxs("div",{className:"connection-actions",children:[!i.connected&&!i.connecting&&e.jsx("button",{className:"connect-button primary",onClick:v,children:"Connect"}),i.connecting&&e.jsxs("button",{className:"connect-button connecting",disabled:!0,children:[e.jsx("span",{className:"spinner"}),"Connecting..."]}),i.connected&&e.jsx("button",{className:"connect-button disconnect",onClick:p,children:"Disconnect"})]})]}),i.error&&e.jsxs("div",{className:"error-message",children:[e.jsx("span",{className:"error-icon",children:"‚ö†Ô∏è"}),e.jsx("span",{className:"error-text",children:i.error}),e.jsx("button",{className:"error-dismiss",onClick:g,children:"√ó"})]}),c&&e.jsxs("div",{className:"discovery-progress",children:[e.jsxs("div",{className:"progress-info",children:[e.jsx("span",{className:"progress-icon",children:"üîç"}),e.jsx("span",{children:c})]}),e.jsx("div",{className:"progress-bar",children:e.jsx("div",{className:"progress-fill"})})]}),i.connected&&i.services.length>0&&e.jsxs("div",{className:"connection-summary",children:[e.jsxs("div",{className:"summary-item",children:[e.jsx("span",{className:"summary-label",children:"Services Discovered:"}),e.jsx("span",{className:"summary-value",children:i.services.length})]}),e.jsxs("div",{className:"summary-item",children:[e.jsx("span",{className:"summary-label",children:"Characteristics:"}),e.jsx("span",{className:"summary-value",children:i.characteristics.size})]})]}),i.connected&&e.jsxs("div",{className:"connection-tips",children:[e.jsx("h4",{children:"Connected Successfully!"}),e.jsxs("ul",{children:[e.jsx("li",{children:"‚úÖ Device is now connected and ready"}),e.jsx("li",{children:"üîç Services have been discovered automatically"}),e.jsx("li",{children:"üìä You can now view security analysis and firmware information"}),e.jsx("li",{children:"‚öôÔ∏è Advanced features are available in the device control panel"})]})]})]}):e.jsx("div",{className:"connection-manager",children:e.jsxs("div",{className:"no-device",children:[e.jsx("div",{className:"no-device-icon",children:"üì±"}),e.jsx("p",{children:"No device selected"}),e.jsx("small",{children:"Please scan for and select a Blackmagic device first"})]})})},j=class j{constructor(){y(this,"riskThresholds",{critical:["Nordic DFU Service","File Transfer Profile"],high:["Human Interface Device","Object Push Profile","Audio Source"],medium:["Generic Access Profile","Generic Attribute Profile","Device Information Service","Audio Sink"],low:["Battery Service"]})}static getInstance(){return j.instance||(j.instance=new j),j.instance}generateSecurityAssessment(s){const t=s.map(c=>this.getServiceName(c.uuid)),i=this.assessServiceRisks(t),n=this.determineHighestRisk(i),r=this.generateRecommendations(t,i);return{riskLevel:n,services:t,recommendations:r}}assessServiceRisks(s){const t={};return s.forEach(i=>{this.riskThresholds.critical.some(n=>i.includes(n))?t[i]="Critical":this.riskThresholds.high.some(n=>i.includes(n))?t[i]="High":this.riskThresholds.medium.some(n=>i.includes(n))?t[i]="Medium":t[i]="Low"}),t}determineHighestRisk(s){const t=Object.values(s);return t.includes("Critical")?"Critical":t.includes("High")?"High":t.includes("Medium")?"Medium":"Low"}generateRecommendations(s,t){const i=[],n=s.some(p=>p.includes("DFU")),r=s.some(p=>p.includes("File Transfer")),c=s.some(p=>p.includes("Human Interface")),u=s.some(p=>p.includes("Object Push")),v=s.some(p=>p.includes("Audio Source"));return n&&(i.push("üö® CRITICAL: Nordic DFU Service detected - Firmware modification possible"),i.push("üìã Monitor all DFU operations and implement access controls"),i.push("üîí Consider disabling DFU service when not actively updating firmware")),r&&(i.push("üö® CRITICAL: File Transfer Profile detected - File system access possible"),i.push("üìã Implement strict file access controls and validation"),i.push("üîç Monitor all file transfer operations for suspicious activity")),c&&(i.push("‚ö†Ô∏è HIGH RISK: Human Interface Device service - Remote control capability"),i.push("üìã Implement user confirmation for critical camera operations"),i.push("üîê Consider implementing operation timeouts and session limits")),u&&(i.push("‚ö†Ô∏è HIGH RISK: Object Push Profile - File upload capability detected"),i.push("üìã Validate all uploaded files and scan for malicious content"),i.push("üíæ Implement file size limits and type restrictions")),v&&(i.push("‚ö†Ô∏è HIGH RISK: Audio Source service - Microphone access for surveillance"),i.push("üìã Monitor audio streaming sessions and implement privacy controls"),i.push("üîá Provide clear indicators when audio is being accessed")),i.push("üìä Regularly audit Bluetooth connections and active services"),i.push("üîÑ Keep firmware updated to patch known vulnerabilities"),i.push("üìù Maintain logs of all Bluetooth operations for security analysis"),(t.Critical||t.High)&&(i.push("üö´ Disable Bluetooth when not actively needed"),i.push("üõ°Ô∏è Implement network segmentation for camera devices")),i}analyzeServiceSecurity(s){const t=this.getServiceName(s),i=Object.values(k).find(n=>this.formatUuidForWebBluetooth(n.uuid)===s);return i?this.getServiceThreatProfile(i):{serviceName:t,riskLevel:"Low",threats:["Unknown service - limited threat assessment available"],mitigations:["Monitor service usage","Disable if not needed"]}}getServiceThreatProfile(s){const t=s.name;let i="Low";const n=[],r=[];switch(t){case"Nordic DFU Service":i="Critical",n.push("Firmware replacement and modification","Bootloader compromise","Persistent backdoor installation","Device bricking through malformed updates"),r.push("Implement cryptographic signature verification","Use secure boot process","Restrict DFU access to authenticated users only","Maintain firmware rollback capability");break;case"File Transfer Profile":i="Critical",n.push("Unauthorized file system access","Data exfiltration","Malicious file injection","Storage exhaustion attacks"),r.push("Implement strict file access controls","Validate all file operations","Use sandboxed file access","Monitor file system operations");break;case"Human Interface Device":i="High",n.push("Unauthorized camera control","Recording manipulation","Settings modification","Remote operation without user consent"),r.push("Require user confirmation for critical operations","Implement operation logging","Use session timeouts","Provide visual indicators for remote control");break;case"Object Push Profile":i="High",n.push("Malicious file uploads","Storage space exhaustion","Configuration file manipulation","Script injection attacks"),r.push("Validate file types and content","Implement file size limits","Scan uploads for malicious content","Use secure file handling practices");break;case"Audio Source":i="High",n.push("Unauthorized microphone access","Audio surveillance","Privacy violations","Covert recording"),r.push("Provide clear audio access indicators","Implement user consent mechanisms","Monitor audio streaming sessions","Allow user to disable audio access");break;case"Generic Access Profile":case"Generic Attribute Profile":case"Device Information Service":i="Medium",n.push("Device fingerprinting","Information disclosure","Connection manipulation"),r.push("Limit exposed device information","Monitor connection attempts","Implement rate limiting");break;default:i="Low",n.push("Standard service with minimal security risk"),r.push("Follow standard Bluetooth security practices")}return{serviceName:t,riskLevel:i,threats:n,mitigations:r,occurrences:s.verified.littleEndian.occurrences+s.verified.bigEndian.occurrences}}generateAuditReport(s){const t=this.generateSecurityAssessment(s),i=s.map(v=>this.analyzeServiceSecurity(v.uuid)),n=i.filter(v=>v.riskLevel==="Critical"),r=i.filter(v=>v.riskLevel==="High"),c=i.filter(v=>v.riskLevel==="Medium"),u=i.filter(v=>v.riskLevel==="Low");return{summary:t,serviceBreakdown:{critical:n,high:r,medium:c,low:u},totalServices:s.length,riskDistribution:{critical:n.length,high:r.length,medium:c.length,low:u.length},overallRisk:t.riskLevel,generatedAt:new Date().toISOString()}}requiresSecurityConfirmation(s,t){const i=this.getServiceName(s);return this.riskThresholds.critical.some(n=>i.includes(n))?!0:this.riskThresholds.high.some(n=>i.includes(n))?["write","execute","upload","download","control"].some(r=>t.toLowerCase().includes(r)):!1}formatUuidForWebBluetooth(s){return`0000${s.toString(16).padStart(4,"0")}-0000-1000-8000-00805f9b34fb`}getServiceName(s){return{"00001800-0000-1000-8000-00805f9b34fb":"Generic Access Profile","00001801-0000-1000-8000-00805f9b34fb":"Generic Attribute Profile","0000180a-0000-1000-8000-00805f9b34fb":"Device Information Service","0000180f-0000-1000-8000-00805f9b34fb":"Battery Service","00001812-0000-1000-8000-00805f9b34fb":"Human Interface Device","0000110a-0000-1000-8000-00805f9b34fb":"Audio Source","0000110b-0000-1000-8000-00805f9b34fb":"Audio Sink","00001105-0000-1000-8000-00805f9b34fb":"Object Push Profile","00001106-0000-1000-8000-00805f9b34fb":"File Transfer Profile","0000fe59-0000-1000-8000-00805f9b34fb":"Nordic DFU Service"}[s]||`Unknown Service (${s})`}};y(j,"instance");let w=j;const S=class S{constructor(){y(this,"analysisCache",new Map)}static getInstance(){return S.instance||(S.instance=new S),S.instance}async analyzeFirmware(s){const t=s.map(n=>n.uuid).sort().join(",");if(this.analysisCache.has(t))return this.analysisCache.get(t);const i={version:await this.detectFirmwareVersion(s),updateCapable:this.detectUpdateCapability(s),otaPatterns:this.countOTAPatterns(),dfuPatterns:this.countDFUPatterns(),totalOccurrences:this.calculateTotalOccurrences()};return this.analysisCache.set(t,i),i}async detectFirmwareVersion(s){const t=s.find(i=>i.uuid==="0000180a-0000-1000-8000-00805f9b34fb");if(!t)return null;try{const n=(await t.getCharacteristics()).find(r=>r.uuid==="00002a26-0000-1000-8000-00805f9b34fb");if(n&&n.properties.read){const r=await n.readValue();return new TextDecoder().decode(r)}}catch(i){console.warn("Failed to read firmware version:",i)}return null}detectUpdateCapability(s){return!!s.find(i=>i.uuid==="0000fe59-0000-1000-8000-00805f9b34fb")}countOTAPatterns(){return 13}countDFUPatterns(){return 9}calculateTotalOccurrences(){let s=0;return Object.values(k).forEach(t=>{s+=t.verified.littleEndian.occurrences,s+=t.verified.bigEndian.occurrences}),Object.values($).forEach(t=>{s+=t.verified.occurrences}),Object.values(V).forEach(t=>{s+=t.occurrences}),s}createMemoryAnalysis(){const s=[];return s.push({offset:117159,hexContext:"06006B3591A3EA050000EA0500007C2E0DA7DADC00E04C602A580800450005DC00184000FF06BB69A9FE10F2A9FE55ABEBFF00509BD1794175DDC23F50101000",asciiContext:"..k5..........|.......L`*X..E.....@....i......U....P..yAu..?P...",serviceType:"Generic Access Profile"}),s.push({offset:667247,hexContext:"75DDC23F50101000CD7D0000A8667A81D976409D81CB529D83E0548CF54DB4A701050CF4F57C031D8776F2A41E24BE49514109137A3DBC4FEC73F36FC0A6F093",asciiContext:"u..?P....}...fz..v@...R...T..M.......|...v...$.IQA..z=.O.s.o....",serviceType:"HCI Command Layer"}),s.push({offset:1872656,hexContext:"95DFB3AD6815D3DCF7861538B2841A14106FF2AC5E0BA4421A4384EE251138C94F54415D78BD037DD22748629D74587FAA20E13AD69E4CA8CA5F8BA33C9521A8",asciiContext:"....h......8.....o..^..B.C..%.8.OTA]x..}.(Hb.tX.. .:..L.._..<.!.",serviceType:"Firmware Update (OTA)"}),s.push({offset:56032,hexContext:"694E76198AAEC938C9D1DD706AF77FA79C7320D4F1AF328A67E5C318EF26C86059FE9FFF067A20896B527D3FFE25CBBA251B29B1E8FDC42485EDF6002DE98479",asciiContext:"iNv....8...pj....s ...2.g....&.`Y....z .kR}?.%..%.)....$....-..y",serviceType:"Nordic DFU Service"}),s}analyzeServicePatterns(s){const t={discoveredServices:s.map(c=>({uuid:c.uuid,name:this.getServiceName(c.uuid),present:!0})),expectedServices:Object.values(k).map(c=>({uuid:this.formatUuidForWebBluetooth(c.uuid),name:c.name,occurrences:c.verified.littleEndian.occurrences+c.verified.bigEndian.occurrences})),matchRate:0},i=new Set(s.map(c=>c.uuid)),n=t.expectedServices.map(c=>c.uuid),r=n.filter(c=>i.has(c));return t.matchRate=r.length/n.length*100,t}getServiceDetails(s){const t=Object.values(k).find(i=>this.formatUuidForWebBluetooth(i.uuid)===s);return t?{name:t.name,uuid:t.uuid,webBluetoothUuid:s,verified:t.verified,totalOccurrences:t.verified.littleEndian.occurrences+t.verified.bigEndian.occurrences,riskAssessment:this.assessServiceRisk(t)}:null}assessServiceRisk(s){const t=s.verified.littleEndian.occurrences+s.verified.bigEndian.occurrences;return s.name.includes("DFU")||s.name.includes("File Transfer")?"Critical":s.name.includes("Human Interface")||s.name.includes("Object Push")||s.name.includes("Audio Source")?"High":t>4e3?"Medium":"Low"}formatUuidForWebBluetooth(s){return`0000${s.toString(16).padStart(4,"0")}-0000-1000-8000-00805f9b34fb`}getServiceName(s){return{"00001800-0000-1000-8000-00805f9b34fb":"Generic Access Profile","00001801-0000-1000-8000-00805f9b34fb":"Generic Attribute Profile","0000180a-0000-1000-8000-00805f9b34fb":"Device Information Service","0000180f-0000-1000-8000-00805f9b34fb":"Battery Service","00001812-0000-1000-8000-00805f9b34fb":"Human Interface Device","0000fe59-0000-1000-8000-00805f9b34fb":"Nordic DFU Service"}[s]||`Unknown Service (${s})`}clearCache(){this.analysisCache.clear()}};y(S,"instance");let A=S;const C=class C{constructor(){}static getInstance(){return C.instance||(C.instance=new C),C.instance}processDiscoveredServices(s){return s.map(t=>({uuid:t.serviceUuid,name:t.serviceName,characteristics:t.characteristics.map(i=>({uuid:i.uuid,properties:i.properties,value:i.value?this.parseCharacteristicValue(i.value):null,readable:i.properties.includes("read"),writable:i.properties.includes("write")||i.properties.includes("writeWithoutResponse"),notifiable:i.properties.includes("notify")||i.properties.includes("indicate")})),riskLevel:this.assessServiceRisk(t.serviceName),verificationStatus:this.verifyServicePattern(t.serviceUuid)}))}parseCharacteristicValue(s){try{const t=new Uint8Array(s.buffer);return t.length===0?null:this.isUtf8String(t)?new TextDecoder().decode(t):t.length===1?t[0]:t.length===2?s.getUint16(0,!0):t.length===4?s.getUint32(0,!0):Array.from(t).map(i=>`0x${i.toString(16).padStart(2,"0")}`).join(" ")}catch(t){return console.warn("Failed to parse characteristic value:",t),null}}isUtf8String(s){try{const t=new TextDecoder("utf-8",{fatal:!0}).decode(s);return/^[\x20-\x7E\s]*$/.test(t)}catch{return!1}}assessServiceRisk(s){return s.includes("DFU")||s.includes("File Transfer")?"Critical":s.includes("Human Interface")||s.includes("Object Push")||s.includes("Audio Source")?"High":s.includes("Generic Access")||s.includes("Generic Attribute")||s.includes("Device Information")||s.includes("Audio Sink")?"Medium":"Low"}verifyServicePattern(s){return["00001800-0000-1000-8000-00805f9b34fb","00001801-0000-1000-8000-00805f9b34fb","0000180a-0000-1000-8000-00805f9b34fb","0000180f-0000-1000-8000-00805f9b34fb","00001812-0000-1000-8000-00805f9b34fb","0000fe59-0000-1000-8000-00805f9b34fb"].includes(s)?"verified":s.startsWith("0000")&&s.endsWith("-0000-1000-8000-00805f9b34fb")?"unknown":"suspicious"}aggregateServiceStatistics(s){const t={totalServices:s.length,totalCharacteristics:s.reduce((i,n)=>i+n.characteristics.length,0),riskDistribution:{critical:s.filter(i=>i.riskLevel==="Critical").length,high:s.filter(i=>i.riskLevel==="High").length,medium:s.filter(i=>i.riskLevel==="Medium").length,low:s.filter(i=>i.riskLevel==="Low").length},verificationStatus:{verified:s.filter(i=>i.verificationStatus==="verified").length,unknown:s.filter(i=>i.verificationStatus==="unknown").length,suspicious:s.filter(i=>i.verificationStatus==="suspicious").length},capabilities:{readable:s.reduce((i,n)=>i+n.characteristics.filter(r=>r.readable).length,0),writable:s.reduce((i,n)=>i+n.characteristics.filter(r=>r.writable).length,0),notifiable:s.reduce((i,n)=>i+n.characteristics.filter(r=>r.notifiable).length,0)}};return{...t,overallRisk:this.calculateOverallRisk(t.riskDistribution),verificationScore:this.calculateVerificationScore(t.verificationStatus,t.totalServices)}}calculateOverallRisk(s){return(s.critical||0)>0?"Critical":(s.high||0)>0?"High":(s.medium||0)>0?"Medium":"Low"}calculateVerificationScore(s,t){return Math.round((s.verified||0)/t*100)}generateAnalysisReport(s,t,i){const n=this.aggregateServiceStatistics(s);return{timestamp:new Date().toISOString(),deviceInfo:{servicesDiscovered:s.length,verificationScore:n.verificationScore,overallRisk:n.overallRisk},firmwareInfo:{version:t.version,updateCapable:t.updateCapable,otaPatterns:t.otaPatterns,dfuPatterns:t.dfuPatterns},securityAssessment:{riskLevel:i.riskLevel,recommendations:i.recommendations,criticalServices:s.filter(r=>r.riskLevel==="Critical").map(r=>r.name)},statistics:n,services:s.map(r=>({name:r.name,uuid:r.uuid,riskLevel:r.riskLevel,verificationStatus:r.verificationStatus,characteristicCount:r.characteristics.length,capabilities:{read:r.characteristics.filter(c=>c.readable).length,write:r.characteristics.filter(c=>c.writable).length,notify:r.characteristics.filter(c=>c.notifiable).length}}))}}exportToCSV(s,t){if(!s||s.length===0){console.warn("No data to export");return}const i=Object.keys(s[0]),n=[i.join(","),...s.map(r=>i.map(c=>{const u=r[c];return u==null?"":typeof u=="object"?JSON.stringify(u):`"${String(u).replace(/"/g,'""')}"`}).join(","))].join(`
`);this.downloadFile(n,`${t}.csv`,"text/csv")}exportToJSON(s,t){const i=JSON.stringify(s,null,2);this.downloadFile(i,`${t}.json`,"application/json")}downloadFile(s,t,i){const n=new Blob([s],{type:i}),r=URL.createObjectURL(n),c=document.createElement("a");c.href=r,c.download=t,document.body.appendChild(c),c.click(),document.body.removeChild(c),URL.revokeObjectURL(r)}};y(C,"instance");let F=C;const X=({services:a,onSecurityAssessment:s,onFirmwareAnalysis:t})=>{const[i,n]=o.useState(null),[r,c]=o.useState(!1),[u,v]=o.useState({}),p=o.useMemo(()=>w.getInstance(),[]),g=o.useMemo(()=>A.getInstance(),[]),l=o.useMemo(()=>F.getInstance(),[]),h=o.useMemo(()=>l.processDiscoveredServices(a),[a,l]),f=o.useMemo(()=>l.aggregateServiceStatistics(h),[h,l]),m=o.useCallback(d=>{n(i===d?null:d)},[i]),b=o.useCallback(d=>{v(x=>({...x,[d]:!x[d]}))},[]),O=o.useCallback(async()=>{if(a.length!==0)try{const d=a.map(()=>({})),x=p.generateSecurityAssessment(d);s(x);const N=await g.analyzeFirmware(d);t(N),c(!0)}catch(d){console.error("Analysis failed:",d)}},[a,p,g,s,t]),E=d=>{switch(d){case"Critical":return"#e53e3e";case"High":return"#dd6b20";case"Medium":return"#d69e2e";case"Low":return"#38a169";default:return"#718096"}},U=d=>{switch(d){case"verified":return"#38a169";case"unknown":return"#d69e2e";case"suspicious":return"#e53e3e";default:return"#718096"}};return a.length===0?e.jsx("div",{className:"service-explorer",children:e.jsxs("div",{className:"no-services",children:[e.jsx("div",{className:"no-services-icon",children:"üîç"}),e.jsx("p",{children:"No services discovered"}),e.jsx("small",{children:"Connect to a device first to explore its services"})]})}):e.jsxs("div",{className:"service-explorer",children:[e.jsxs("div",{className:"explorer-header",children:[e.jsx("h3",{children:"Service Explorer"}),e.jsx("div",{className:"header-actions",children:e.jsx("button",{className:"analysis-button",onClick:O,disabled:r,children:r?"‚úÖ Analysis Complete":"üî¨ Run Analysis"})})]}),e.jsxs("div",{className:"service-stats",children:[e.jsxs("div",{className:"stat-card",children:[e.jsx("div",{className:"stat-value",children:f.totalServices}),e.jsx("div",{className:"stat-label",children:"Services"})]}),e.jsxs("div",{className:"stat-card",children:[e.jsx("div",{className:"stat-value",children:f.totalCharacteristics}),e.jsx("div",{className:"stat-label",children:"Characteristics"})]}),e.jsxs("div",{className:"stat-card",children:[e.jsx("div",{className:"stat-value",style:{color:E(f.overallRisk)},children:f.overallRisk}),e.jsx("div",{className:"stat-label",children:"Risk Level"})]}),e.jsxs("div",{className:"stat-card",children:[e.jsxs("div",{className:"stat-value",children:[f.verificationScore,"%"]}),e.jsx("div",{className:"stat-label",children:"Verified"})]})]}),e.jsx("div",{className:"services-list",children:h.map(d=>e.jsxs("div",{className:"service-item",children:[e.jsxs("div",{className:"service-header",onClick:()=>m(d.uuid),children:[e.jsxs("div",{className:"service-info",children:[e.jsx("div",{className:"service-name",children:d.name}),e.jsx("div",{className:"service-uuid",children:d.uuid})]}),e.jsxs("div",{className:"service-badges",children:[e.jsx("span",{className:"risk-badge",style:{backgroundColor:E(d.riskLevel),color:"white"},children:d.riskLevel}),e.jsx("span",{className:"verification-badge",style:{backgroundColor:U(d.verificationStatus),color:"white"},children:d.verificationStatus}),e.jsxs("span",{className:"characteristic-count",children:[d.characteristics.length," chars"]})]}),e.jsx("div",{className:"service-expand",children:i===d.uuid?"‚ñº":"‚ñ∂"})]}),i===d.uuid&&e.jsxs("div",{className:"service-details",children:[e.jsx("div",{className:"service-actions",children:e.jsx("button",{className:"toggle-chars-button",onClick:()=>b(d.uuid),children:u[d.uuid]?"Hide Characteristics":`Show ${d.characteristics.length} Characteristics`})}),u[d.uuid]&&e.jsx("div",{className:"characteristics-list",children:d.characteristics.map(x=>e.jsxs("div",{className:"characteristic-item",children:[e.jsxs("div",{className:"characteristic-header",children:[e.jsx("span",{className:"characteristic-uuid",children:x.uuid}),e.jsx("div",{className:"characteristic-properties",children:x.properties.map(N=>e.jsx("span",{className:`property-badge ${N}`,children:N},N))})]}),x.value&&e.jsxs("div",{className:"characteristic-value",children:[e.jsx("strong",{children:"Value:"}),e.jsx("code",{children:JSON.stringify(x.value)})]}),e.jsxs("div",{className:"characteristic-capabilities",children:[x.readable&&e.jsx("span",{className:"capability readable",children:"üìñ Readable"}),x.writable&&e.jsx("span",{className:"capability writable",children:"‚úèÔ∏è Writable"}),x.notifiable&&e.jsx("span",{className:"capability notifiable",children:"üîî Notifiable"})]})]},x.uuid))})]})]},d.uuid))}),r&&e.jsxs("div",{className:"analysis-summary",children:[e.jsx("h4",{children:"Analysis Complete"}),e.jsxs("div",{className:"analysis-results",children:[e.jsxs("div",{className:"result-item",children:[e.jsx("span",{className:"result-label",children:"Security Assessment:"}),e.jsx("span",{className:"result-value",children:"Generated"})]}),e.jsxs("div",{className:"result-item",children:[e.jsx("span",{className:"result-label",children:"Firmware Analysis:"}),e.jsx("span",{className:"result-value",children:"Generated"})]}),e.jsxs("div",{className:"result-item",children:[e.jsx("span",{className:"result-label",children:"Risk Distribution:"}),e.jsxs("span",{className:"result-value",children:["üî¥ ",f.riskDistribution.critical," Critical, üü† ",f.riskDistribution.high," High, üü° ",f.riskDistribution.medium," Medium, üü¢ ",f.riskDistribution.low," Low"]})]})]})]})]})},Q={connectionState:{connected:!1,connecting:!1,device:null,services:[],characteristics:new Map,error:null},discoveredServices:[],processedServices:[],securityAssessment:null,firmwareAnalysis:null,isScanning:!1,availableDevices:[]};function Z(){const[a,s]=o.useState(Q),[t,i]=o.useState(null),[n,r]=o.useState("scanner"),c=o.useCallback(m=>{i(m),s(b=>({...b,availableDevices:b.availableDevices.includes(m)?b.availableDevices:[...b.availableDevices,m]})),r("connection")},[]),u=o.useCallback(m=>{s(b=>({...b,isScanning:m}))},[]),v=o.useCallback(m=>{s(b=>({...b,connectionState:m})),m.connected&&r("services")},[]),p=o.useCallback(m=>{s(b=>({...b,discoveredServices:m}))},[]),g=o.useCallback(m=>{s(b=>({...b,securityAssessment:m}))},[]),l=o.useCallback(m=>{s(b=>({...b,firmwareAnalysis:m}))},[]),h=o.useCallback(m=>{r(m)},[]),f=m=>{switch(m){case"scanner":return!0;case"connection":return t!==null;case"services":return a.connectionState.connected;default:return!1}};return e.jsxs("div",{className:"app",children:[e.jsx("header",{className:"app-header",children:e.jsxs("div",{className:"header-content",children:[e.jsxs("h1",{children:[e.jsx("span",{className:"app-icon",children:"üìπ"}),"Blackmagic Bluetooth Interface"]}),e.jsx("div",{className:"header-status",children:t&&e.jsxs("div",{className:"device-status",children:[e.jsx("span",{className:"device-name",children:t.name||"Unknown Device"}),e.jsx("span",{className:`connection-indicator ${a.connectionState.connected?"connected":"disconnected"}`,children:a.connectionState.connected?"üü¢ Connected":"üî¥ Disconnected"})]})})]})}),e.jsxs("nav",{className:"app-nav",children:[e.jsxs("button",{className:`nav-tab ${n==="scanner"?"active":""}`,onClick:()=>h("scanner"),disabled:!f("scanner"),children:[e.jsx("span",{className:"tab-icon",children:"üîç"}),"Device Scanner"]}),e.jsxs("button",{className:`nav-tab ${n==="connection"?"active":""}`,onClick:()=>h("connection"),disabled:!f("connection"),children:[e.jsx("span",{className:"tab-icon",children:"üîó"}),"Connection"]}),e.jsxs("button",{className:`nav-tab ${n==="services"?"active":""}`,onClick:()=>h("services"),disabled:!f("services"),children:[e.jsx("span",{className:"tab-icon",children:"‚öôÔ∏è"}),"Services"]})]}),e.jsxs("main",{className:"app-main",children:[n==="scanner"&&e.jsx(J,{onDeviceSelected:c,isScanning:a.isScanning,onScanStateChange:u}),n==="connection"&&e.jsx(Y,{device:t,onConnectionStateChange:v,onServicesDiscovered:p}),n==="services"&&e.jsx(X,{services:a.discoveredServices,onSecurityAssessment:g,onFirmwareAnalysis:l})]}),e.jsx("footer",{className:"app-footer",children:e.jsxs("div",{className:"footer-content",children:[e.jsxs("div",{className:"footer-info",children:[e.jsx("span",{children:"Blackmagic Bluetooth Interface v1.0.0"}),e.jsx("span",{children:"‚Ä¢"}),e.jsx("span",{children:"Built with React + TypeScript"}),e.jsx("span",{children:"‚Ä¢"}),e.jsx("span",{children:"Web Bluetooth API"})]}),e.jsx("div",{className:"footer-stats",children:a.connectionState.connected&&e.jsxs(e.Fragment,{children:[e.jsxs("span",{children:[a.discoveredServices.length," Services"]}),e.jsx("span",{children:"‚Ä¢"}),e.jsxs("span",{children:[a.connectionState.characteristics.size," Characteristics"]}),a.securityAssessment&&e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"‚Ä¢"}),e.jsxs("span",{children:["Risk: ",a.securityAssessment.riskLevel]})]})]})})]})})]})}const ee=L(document.getElementById("root"));ee.render(e.jsx(o.StrictMode,{children:e.jsx(Z,{})}));
//# sourceMappingURL=index-_ENdEnRU.js.map
